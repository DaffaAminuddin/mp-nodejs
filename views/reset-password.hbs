<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="robots" content="noindex, nofollow">
    <title>Reset Password</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&display=swap">
    <link rel="stylesheet" href="/styles-2.css">
    <link rel="stylesheet" href="/mdb.min.css">    
    <style>
        .container {
            max-width: 400px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 20px;
            text-align: center;
        }
               
        .verification-container {
            display: flex;
            justify-content: space-between;
            gap: 10px; /* Jarak antar digit */
        }

        .verification-box {
            width: 60px; /* Ukuran besar untuk digit */
            height: 60px;
            text-align: center;
            font-size: 24px; /* Ukuran teks besar */
            border: 2px solid #ced4da;
            border-radius: 5px;
            outline: none;
            box-shadow: 0px 2px 5px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        ..verification-box:focus {
            border-color: #007bff;
            box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
        }

        ..verification-box:hover {
            border-color: #6c757d;
        }        
    </style>
</head>

<body class="">    
    
    {{!-- Heroes --}}
    <!-- Authentication Form -->
    <div class="auth-container d-flex justify-content-center align-items-center pt-5 mt-5">
        <div class="form-container">
            <h2 class="text-center">Reset Password</h2>
            <form action="/auth/reset-password" method="POST">
                <p class="text-center text-muted mb-4">Please verify your code and reset your password below.</p>
                <label for="code" class="form-label">Enter Verification Code</label>
                <div class="verification-container">
                    <!-- Code Verification Visual Boxes -->
                    <input type="text" id="box1" class="verification-box" maxlength="1" oninput="moveFocus(this, 'box2')">
                    <input type="text" id="box2" class="verification-box" maxlength="1" oninput="moveFocus(this, 'box3')">
                    <input type="text" id="box3" class="verification-box" maxlength="1" oninput="moveFocus(this, 'box4')">
                    <input type="text" id="box4" class="verification-box" maxlength="1" oninput="moveFocus(this, 'box5')">
                    <input type="text" id="box5" class="verification-box" maxlength="1" oninput="moveFocus(this, 'hiddenCode', true)">
                </div>

                <!-- Hidden input for the full code -->
                <input type="hidden" id="hiddenCode" name="code">
                <br>
                <!-- Reset Password Section -->
                <div class="form-outline mb-3" data-mdb-input-init>
                    <input type="password" class="form-control" id="password" name="password" required>
                    <label for="password" class="form-label">Enter your new password</label>                
                </div>
                <div class="form-outline mb-3" data-mdb-input-init>
                    <input type="password" class="form-control" id="passwordConfirm" name="passwordConfirm" required>
                    <label for="passwordConfirm" class="form-label">Confirm New Password</label>                
                </div>
                <button type="submit" class="btn btn-primary w-100 mt-4">Reset</button>
            </form>
            {{#if message }}
        <div class="alert alert-danger mt-4 d-flex align-items-center">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-exclamation-triangle-fill flex-shrink-0 me-2" viewBox="0 0 16 16" role="img" aria-label="Warning:">
                <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
            </svg>
            <div>{{message}}</div>
        </div>
        {{/if}}

        {{#if message2 }}
        <div class="alert alert-success mt-4 d-flex align-items-center">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-exclamation-triangle-fill flex-shrink-0 me-2" viewBox="0 0 16 16" role="img" aria-label="Success:">
                <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z"/>
            </svg>
            <div>{{message2}}</div>
        </div>
        {{/if}}

        {{#if message3 }}
        <div class="alert alert-danger mt-4 d-flex align-items-center">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-exclamation-triangle-fill flex-shrink-0 me-2" viewBox="0 0 16 16" role="img" aria-label="Warning:">
                <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
            </svg>
            <div>Your account is not activated yet <a href="/auth/resend-verification-email?email={{message3}}" style="text-decoration: none;">Resend verification email</a></div>              
        </div>
        {{/if}}
        </div>
    </div>

    
    <script>
                
        function moveFocus(currentBox, nextBoxId, isLast = false) {
            const currentValue = currentBox.value;

            // If the current box is filled, move focus to the next box
            if (currentValue.length === 1) {
                const nextBox = document.getElementById(nextBoxId);
                if (nextBox) nextBox.focus();
            }

            // Combine all the values into the hidden input
            const boxes = document.querySelectorAll('.verification-box');
            const hiddenCode = document.getElementById('hiddenCode');
            hiddenCode.value = Array.from(boxes).map(box => box.value).join('');
        }

        const verificationInputs = document.querySelectorAll('.verification-box');
        
        verificationInputs.forEach((input, index) => {
            input.addEventListener('input', (e) => {
                if (e.target.value.length === 1 && index < verificationInputs.length - 1) {
                    verificationInputs[index + 1].focus(); // Pindah ke input berikutnya
                }
            });

            input.addEventListener('paste', (e) => {
                const pastedData = e.clipboardData.getData('text');
                if (pastedData.length === verificationInputs.length) {
                    // Memasukkan setiap karakter ke input field
                    verificationInputs.forEach((field, i) => {
                        field.value = pastedData[i];
                    });
                    verificationInputs[verificationInputs.length - 1].focus(); // Fokus ke input terakhir
                }
                e.preventDefault();
            });

            input.addEventListener('keydown', (e) => {
                if (e.key === "Backspace" && input.value === "" && index > 0) {
                    verificationInputs[index - 1].focus(); // Kembali ke input sebelumnya
                }
            });
        });
                
    </script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script>
    <script type="text/javascript" src="/mdb.umd.min.js"></script>
</body>

</html>